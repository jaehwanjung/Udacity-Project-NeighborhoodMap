!function(){"use strict";window.Position=function(e,n){this.lat=e,this.lng=n},window.Position.prototype.toString=function(){return"{lat: "+this.lat+", lng: "+this.lng+"}"}}(),function(){"use strict";window.Marker=function(e,n,t,o){this.identifier=e,this.showFunction=n,this.hideFunction=t,this.clickFunction=o},window.Marker.prototype.show=function(){this.showFunction()},window.Marker.prototype.hide=function(){this.hideFunction()},window.Marker.prototype.click=function(){this.clickFunction()}}(),function(){"use strict";function e(e,n){return e+n.toString()}function n(e,n,t){return void 0===e||void 0===e[n]?t:e[n]}window.Venue=function(t){this.name=t.name,this.contact=n(t.contact,"formattedPhone","No contact information"),this.address=n(t.location,"formattedAddress","No address"),this.position=new Position(t.location.lat,t.location.lng),this.category=n(t.categories[0],"name","No category"),this.url=n(t,"url","No Url"),this.identifier=e(this.name,this.position)}}(),function(){"use strict";function e(e){var n=document.createElement("script");n.type="text/javascript",n.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDYFVxtFk26wbfNGXDY2JWcQWx-0EXyRz4&v=3.exp&signed_in=false&libraries=places&callback="+e,document.body.appendChild(n)}function n(e,n){t(),o(n),i(e)}function t(){var e={center:{lat:49.283742,lng:-123.122575},zoom:18};f=new google.maps.Map(v,e),p=new google.maps.Geocoder}function o(e){var n=new google.maps.places.Autocomplete(w,{types:["geocode"]});google.maps.event.addListener(n,"place_changed",function(){e(n.getPlace().formatted_address)})}function i(e){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(n){r(n),e&&e()},s):c()}function r(e){var n=new Position(e.coords.latitude,e.coords.longitude);a(n)}function a(e){g=e,f.setCenter(e)}function s(){alert("Geocode failed. Can't get the user's current position.")}function c(){alert("Browser doesn't support Geolocation. Can't get the user's current position")}function u(e,n){p.geocode({address:e},function(e,t){if(t==google.maps.GeocoderStatus.OK){var o=e[0].geometry.location,i=new Position(o.lat(),o.lng());a(i),n()}else alert("Geocode was not successful for the following reason: "+t)})}function l(e){var n=new google.maps.Marker({position:e.position,map:f,title:e.name}),t='<p class="marker-infoWindow-title">'+e.name+'</p><div  class="marker-infoWindow-content"<p>'+e.contact+"</p><p>"+e.address+"</p><p>"+e.category+"</p><p>"+e.url+"</p></div>",o=new google.maps.InfoWindow({content:t});google.maps.event.addListener(n,"click",function(){h&&h.close(),o.open(f,n),h=o});var i=function(){n.setMap(f)},r=function(){n.setMap(null)},a=function(){google.maps.event.trigger(n,"click"),f.panTo(n.position)},s=e.identifier;return new Marker(s,i,r,a)}function d(){return g}var f,p,g,h,v=$("#map-canvas")[0],w=$("#addressbar")[0];window.map={loadScript:e,initialize:n,centerMapByPosition:a,centerMapByAddress:u,addMarker:l,getCurrentPosition:d}}(),function(){"use strict";function e(e,r){var a=n(e);$.getJSON(a,function(e){if(200==e.meta.code){var n=t(e.response);r(n)}else o()}).fail(i)}function n(e){return r+"client_id="+a.CLIENT_ID+"&client_secret="+a.CLIENT_SECRET+"&limit="+s+"&intent="+c+"&ll="+e.lat+","+e.lng}function t(e){var n=[],t=e.venues;for(var o in t)if(t.hasOwnProperty(o)){var i=t[o],r=new Venue(i);"Neighborhood"!=r.category&&n.push(r)}return n}function o(){alert("Venue search engine failed.")}function i(){alert("Venue search engine could not be reached.")}var r="https://api.foursquare.com/v2/venues/search?",a={CLIENT_ID:"WD5S0ZAJQC3SHWEQYVZAXKQGMK0IWB3YESWWSGG24YDI54QV",CLIENT_SECRET:"PG3H3TEYU4RFGFL24QNJMESWPOVAH4GED51SYO5YMH5JLERP&v=20130815"},s=50,c="checkin";window.venueSearchEngine={searchTopPicks:e}}(),function(){"use strict";window.ViewModel=function(){function e(e,n,t){return t.indexOf(e)===n}function n(){var e=map.getCurrentPosition(),n=function(e){for(var n in e){if(e.hasOwnProperty(n)){var t=e[n];i[t.identifier]=map.addMarker(t)}o.allVenues.push(t)}};venueSearchEngine.searchTopPicks(e,n)}function t(){o.allVenues.removeAll();for(var e in i)if(i.hasOwnProperty(e)){var n=i[e];n.hide()}i={}}var o=this,i={};o.filterKeyword=ko.observable(""),o.allVenues=ko.observableArray([]),o.isFilterSearchBoxSelected=ko.observable(!1),o.currentAddress=ko.observable(""),o.isVenueListToggled=ko.observable(!0),o.isTypeaheadListMouseOver=ko.observable(!1),o.isTypeaheadListOn=ko.computed(function(){return o.isFilterSearchBoxSelected()||o.isTypeaheadListMouseOver()}),o.allCategories=ko.computed(function(){var n=o.allVenues(),t=$.map(n,function(e){return e.category});return t.filter(e)}),o.filteredCategories=ko.computed(function(){var e=o.filterKeyword(),n=o.allCategories();return $.grep(n,function(n){return""==e||n.toLowerCase().includes(e.toLowerCase())})}),o.filteredVenues=ko.computed(function(){var e=o.filteredCategories(),n=o.allVenues(),t=$.grep(n,function(n){return e.indexOf(n.category)>=0}),r=$.map(t,function(e){return e.identifier});for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];r.indexOf(s.identifier)>=0?s.show():s.hide()}return t}),o.initialize=function(){map.initialize(n,o.setNeighborhood)},o.setNeighborhood=function(e){t();var i=e?e:o.currentAddress();map.centerMapByAddress(i,n)},o.toggleVenueList=function(){var e=o.isVenueListToggled();o.isVenueListToggled(!e)},o.clickVenueMarker=function(e){var n=i[e.identifier];n.click()},o.clickTypeahead=function(e){o.filterKeyword(e)},o.typeaheadListMouseOver=function(){o.isTypeaheadListMouseOver(!0)},o.typeaheadListMouseOut=function(){o.isTypeaheadListMouseOver(!1)},o.loadScript=function(e){map.loadScript(e)}}}();var viewModel=new ViewModel;ko.applyBindings(viewModel),window.onload=function(){viewModel.loadScript("viewModel.initialize")};